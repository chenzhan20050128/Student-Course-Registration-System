<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 当执行某个查询语句之后，MyBatis会获取结果集，并根据映射关系将结果集中的列数据转化为Java对象中的属性。

首先，通过column属性，从数据库结果集找到相应列的数据。
然后，通过property属性，将该数据赋值给Java对象的指定属性。-->
<mapper namespace="com.scrs.mapper.TeacherCourseMapper">
    <resultMap id="teacherCourse" type="com.scrs.pojo.TeacherCourse">
    
        <!-- TeacherCourse 基本字段 -->
        <result column="tc_id" property="id"/>
        <result column="tc_tid" property="tid"/>
        <result column="tc_cid" property="cid"/>

        <!-- 关联 Teacher 对象 -->
        <association property="teacher" javaType="com.scrs.pojo.Teacher">
            <result column="t_id" property="id"/>
            <result column="tname" property="tname"/>
            <result column="password" property="password"/>
            <result column="sex" property="sex"/>
            <result column="email" property="email"/>
            <result column="phone" property="phone"/>
            <result column="age" property="age"/>
            <result column="major" property="major"/>
            <result column="timage" property="timage"/>
        </association>

        <!-- 关联 Course 对象 -->
        <association property="course" javaType="com.scrs.pojo.Course">
            <id column="c_id" property="courseId"/>
            <result column="course_name" property="courseName"/>
            <result column="college" property="college"/>
            <result column="campus" property="campus"/>
            <result column="enrolled_count" property="enrolledCount"/>
            <result column="capacity" property="capacity"/>
            <result column="credits" property="credits"/>
            <result column="instructor_name" property="instructorName"/>
            <result column="description" property="description"/>
            <result column="classroom" property="classroom"/>
            <result column="start_week" property="startWeek"/>
            <result column="end_week" property="endWeek"/>
            <result column="type" property="type"/>
        </association>
    </resultMap>

    <select id="listTeacherCourse" resultMap="teacherCourse">
        SELECT
            tc.id AS tc_id,
            tc.tid AS tc_tid,
            tc.cid AS tc_cid,
            t.id AS t_id,
            t.tname,
            t.password,
            t.sex,
            t.email,
            t.phone,
            t.age,
            t.major,
            t.timage,
            c.course_id AS c_id,
            c.college as college,
            c.capacity as capacity,
            c.course_name as course_name,
            c.campus as campus,
            c.enrolled_count as enrolled_count,
            c.credits as credits,
            c.instructor_name as instructor_name,
            c.description as description,
            c.classroom as classroom,
            c.start_week as start_week,
            c.end_week as end_week,
            c.type as type
        FROM
            teacher_course tc
        JOIN
            teacher t ON t.id = tc.tid
        JOIN
            course c ON c.course_id = tc.cid
        WHERE
            tc.id = #{id}
    </select>





    <select id="listMyCourse" resultMap="teacherCourse">
    select
        tc.id as tc_id, tc.tid as tc_tid, tc.cid as tc_cid,
        t.id as t_id, t.tname, t.password, t.email, t.sex, t.phone, t.age, t.major, t.timage,
        c.course_id as c_id, c.course_name as course_name, c.college as college, c.campus as campus, c.enrolled_count as enrolled_count, c.capacity as capacity, c.credits as credits, c.instructor_name as instructor_name, c.description as description, c.classroom as classroom, c.start_week as start_week, c.end_week as end_week, c.type as type
    from teacher_course tc, teacher t, course c
    <where>
        t.id = tc.tid and c.course_id = tc.cid and tc.id = #{userId}
        <if test="cname != null and cname != ''">
            and c.course_name = #{cname}
        </if>
    </where>
</select>
</mapper>
